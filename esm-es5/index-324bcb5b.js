import{e as getRenderingRef,f as forceUpdate}from"./index-2d9093e5.js";var appendToMap=function(e,n,t){var r=e.get(n);if(!r){e.set(n,[t])}else if(!r.includes(t)){r.push(t)}};var debounce=function(e,n){var t;return function(){var r=[];for(var o=0;o<arguments.length;o++){r[o]=arguments[o]}if(t){clearTimeout(t)}t=setTimeout((function(){t=0;e.apply(void 0,r)}),n)}};var isConnected=function(e){return!("isConnected"in e)||e.isConnected};var cleanupElements=debounce((function(e){for(var n=0,t=e.keys();n<t.length;n++){var r=t[n];e.set(r,e.get(r).filter(isConnected))}}),2e3);var stencilSubscription=function(e){var n=e.on;var t=new Map;if(typeof getRenderingRef==="function"){n("dispose",(function(){t.clear()}));n("get",(function(e){var n=getRenderingRef();if(n){appendToMap(t,e,n)}}));n("set",(function(e){var n=t.get(e);if(n){t.set(e,n.filter(forceUpdate))}cleanupElements(t)}));n("reset",(function(){t.forEach((function(e){return e.forEach(forceUpdate)}));cleanupElements(t)}))}};var createObservableMap=function(e,n){if(n===void 0){n=function(e,n){return e!==n}}var t=new Map(Object.entries(e!==null&&e!==void 0?e:{}));var r={dispose:[],get:[],set:[],reset:[]};var o=function(){t=new Map(Object.entries(e!==null&&e!==void 0?e:{}));r.reset.forEach((function(e){return e()}))};var i=function(){r.dispose.forEach((function(e){return e()}));o()};var u=function(e){r.get.forEach((function(n){return n(e)}));return t.get(e)};var a=function(e,o){var i=t.get(e);if(n(o,i,e)){t.set(e,o);r.set.forEach((function(n){return n(e,o,i)}))}};var f=typeof Proxy==="undefined"?{}:new Proxy(e,{get:function(e,n){return u(n)},ownKeys:function(e){return Array.from(t.keys())},getOwnPropertyDescriptor:function(){return{enumerable:true,configurable:true}},has:function(e,n){return t.has(n)},set:function(e,n,t){a(n,t);return true}});var c=function(e,n){r[e].push(n);return function(){removeFromArray(r[e],n)}};var s=function(n,t){var r=c("set",(function(e,r){if(e===n){t(r)}}));var o=c("reset",(function(){return t(e[n])}));return function(){r();o()}};var v=function(){var e=[];for(var n=0;n<arguments.length;n++){e[n]=arguments[n]}return e.forEach((function(e){if(e.set){c("set",e.set)}if(e.get){c("get",e.get)}if(e.reset){c("reset",e.reset)}}))};return{state:f,get:u,set:a,on:c,onChange:s,use:v,dispose:i,reset:o}};var removeFromArray=function(e,n){var t=e.indexOf(n);if(t>=0){e[t]=e[e.length-1];e.length--}};var createStore=function(e,n){var t=createObservableMap(e,n);stencilSubscription(t);return t};export{createStore as c};