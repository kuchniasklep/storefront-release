var __spreadArray=this&&this.__spreadArray||function(t,e){for(var n=0,r=e.length,o=t.length;n<r;n++,o++)t[o]=e[n];return t};import{r as registerInstance}from"./index-a14dfead.js";import{t as tracker,r as resolve}from"./store-90a4ba2a.js";import"./index-c53317e0.js";var TikTokTracker=function(){function t(){this.ttq=new Promise((function(t){var e=setInterval((function(){if(ttq!==undefined){t(ttq);clearInterval(e)}}),100)}))}t.prototype.pageview=function(){this.ttq.then((function(t){t.track("Browse")}))};t.prototype.product=function(t,e,n,r,o){this.ttq.then((function(t){t.track("ViewContent",{content_type:"product",content_id:e,content_name:n,currency:o,price:r,quantity:1,value:r})}))};t.prototype.addToCart=function(t,e,n,r,o,c){this.ttq.then((function(t){t.track("AddToCart",{content_type:"product",content_id:e,content_name:n,currency:c,price:r,quantity:o,value:r*o})}))};t.prototype.order_checkout=function(t,e,n,r){var o=this;this.ttq.then((function(t){t.track("StartCheckout",{contents:o.transformProducts(e),currency:r,value:n})}))};t.prototype.order_form=function(t,e,n,r){var o=this;this.ttq.then((function(t){t.track("AddBilling",{contents:o.transformProducts(e),value:n,currency:r})}))};t.prototype.order_placed=function(t,e,n,r){var o=this;this.ttq.then((function(t){t.track("Checkout",{contents:o.transformProducts(e),value:n,currency:r})}))};t.prototype.search=function(t){};t.prototype.transformProducts=function(t){return t.map((function(t){return{content_id:t.id,content_type:"product",content_name:t.name,quantity:t.quantity,price:t.price}}))};return t}();var FacebookTracker=function(){function t(t){var e=t.split(", ");this.pixel=new Promise((function(t){!function(t,e,n,r,o,c,a){if(t.fbq)return;o=t.fbq=function(){o.callMethod?o.callMethod.apply(o,arguments):o.queue.push(arguments)};if(!t._fbq)t._fbq=o;o.push=o;o.loaded=!0;o.version="2.0";o.queue=[];c=e.createElement(n);c.async=!0;c.src=r;a=e.getElementsByTagName(n)[0];a.parentNode.insertBefore(c,a)}(window,document,"script","https://connect.facebook.net/en_US/fbevents.js");e.forEach((function(t){fbq("init",t)}));t(fbq)}))}t.prototype.pageview=function(t){this.pixel.then((function(e){e("track","PageView",{},{eventID:t})}))};t.prototype.product=function(t,e,n,r,o){this.pixel.then((function(c){c("track","ViewContent",{content_type:"product",content_name:n,value:r,currency:o,content_ids:[e]},{eventID:t})}))};t.prototype.addToCart=function(t,e,n,r,o,c){this.pixel.then((function(a){a("track","AddToCart",{content_type:"product",content_name:n,value:r,currency:c,contents:[{id:e,quantity:o}]},{eventID:t})}))};t.prototype.order_checkout=function(t,e,n,r){var o=this;this.pixel.then((function(c){c("track","InitiateCheckout",{contents:o.transformProducts(e),content_type:"product",value:n,currency:r},{eventID:t})}))};t.prototype.order_form=function(t,e,n,r){};t.prototype.order_placed=function(t,e,n,r){var o=this;this.pixel.then((function(c){c("track","Purchase",{contents:o.transformProducts(e),content_type:"product",value:n,currency:r},{eventID:t})}))};t.prototype.search=function(t){this.pixel.then((function(e){e("track","Search",{search_string:t})}))};t.prototype.transformProducts=function(t){return t.map((function(t){return{id:t.id,quantity:t.quantity}}))};return t}();var Tracker=function(){function t(t){registerInstance(this,t)}t.prototype.componentWillLoad=function(){var t=this;tracker.get("loaded").then((function(){if(t.tiktok)t.appendTracker(new TikTokTracker);if(t.facebook)t.appendTracker(new FacebookTracker(t.facebook));resolve()}))};t.prototype.appendTracker=function(t){tracker.set("trackers",__spreadArray(__spreadArray([],tracker.get("trackers")),[t]))};return t}();export{Tracker as ks_tracker};